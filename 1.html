<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulación de Carreras</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <h1>Simulación de Carreras</h1>
    
    <!-- Formulario para crear vehículos -->
    <h2>Crear Vehículo</h2>
    <form id="vehicleForm">
        <input type="text" id="vehicleModel" placeholder="Modelo del Vehículo" required>
        <select id="vehicleTraction" required>
            <option value="blanda">Blanda</option>
            <option value="media">Media</option>
            <option value="dura">Dura</option>
        </select>
        <input type="number" id="vehicleMinSpeed" placeholder="Velocidad Mínima" required>
        <input type="number" id="vehicleMaxSpeed" placeholder="Velocidad Máxima" required>
        <button type="submit">Crear Vehículo</button>
    </form>
    
    <!-- Formulario para crear participantes -->
    <h2>Crear Participante</h2>
    <form id="participantForm">
        <input type="text" id="participantName" placeholder="Nombre del Participante" required>
        <select id="participantVehicle" required>
            <option value="">Selecciona Vehículo</option>
        </select>
        <button type="submit">Crear Participante</button>
    </form>

    <!-- Formulario para crear circuitos -->
    <h2>Crear Circuito</h2>
    <form id="circuitForm">
        <input type="text" id="circuitName" placeholder="Nombre del Circuito" required>
        <select id="circuitWeather" required>
            <option value="seco">Seco</option>
            <option value="húmedo">Húmedo</option>
            <option value="lluvioso">Lluvioso</option>
        </select>
        <input type="number" id="circuitLength" placeholder="Longitud del Circuito (m)" required>
        <button type="submit">Crear Circuito</button>
    </form>

    <!-- Mostrar Participantes -->
    <h2>Participantes</h2>
    <ul id="participantList"></ul>

    <!-- Mostrar Circuitos -->
    <h2>Circuitos Disponibles</h2>
    <ul id="circuitList"></ul>

    <!-- Sección para ver la simulación -->
    <h2>Simulación de Carrera</h2>
    <div id="raceStatus">
        <button id="startRaceButton" onclick="startRace()">Iniciar Carrera</button>
        <div id="raceResults"></div>
    </div>

    <script>
        // Variables globales
let vehicles = [];
let participants = [];
let circuits = [];
let currentRace = null;

// Función para agregar un vehículo
document.getElementById('vehicleForm').addEventListener('submit', function (e) {
    e.preventDefault();
    
    const model = document.getElementById('vehicleModel').value;
    const traction = document.getElementById('vehicleTraction').value;
    const minSpeed = parseInt(document.getElementById('vehicleMinSpeed').value);
    const maxSpeed = parseInt(document.getElementById('vehicleMaxSpeed').value);
    
    const vehicle = new Vehiculo(model, traction, minSpeed, maxSpeed);
    vehicles.push(vehicle);
    
    const vehicleOption = document.createElement('option');
    vehicleOption.value = model;
    vehicleOption.textContent = model;
    document.getElementById('participantVehicle').appendChild(vehicleOption);
    
    alert('Vehículo creado!');
});

// Función para agregar un participante
document.getElementById('participantForm').addEventListener('submit', function (e) {
    e.preventDefault();
    
    const name = document.getElementById('participantName').value;
    const vehicleModel = document.getElementById('participantVehicle').value;
    const vehicle = vehicles.find(v => v.modelo === vehicleModel);
    
    if (vehicle) {
        const participant = new Participante(name, vehicle);
        participants.push(participant);
        
        const participantItem = document.createElement('li');
        participantItem.textContent = `${name} - Vehículo: ${vehicle.modelo}`;
        document.getElementById('participantList').appendChild(participantItem);
        
        alert('Participante creado!');
    } else {
        alert('Por favor selecciona un vehículo!');
    }
});

// Función para agregar un circuito
document.getElementById('circuitForm').addEventListener('submit', function (e) {
    e.preventDefault();
    
    const name = document.getElementById('circuitName').value;
    const weather = document.getElementById('circuitWeather').value;
    const length = parseInt(document.getElementById('circuitLength').value);
    
    const circuit = new Circuito(name, weather, length);
    circuits.push(circuit);
    
    const circuitItem = document.createElement('li');
    circuitItem.textContent = `${name} - Tiempo: ${weather} - Longitud: ${length}m`;
    document.getElementById('circuitList').appendChild(circuitItem);
    
    alert('Circuito creado!');
});

// Función para iniciar la carrera
function startRace() {
    const selectedCircuit = circuits[0]; // Aquí seleccionarías el circuito actual
    
    // Iniciar carrera con los participantes y el circuito
    currentRace = new RaceSimulation(selectedCircuit, participants);
    currentRace.start();
}

// Clase de simulación de carrera
class RaceSimulation {
    constructor(circuito, participantes) {
        this.circuito = circuito;
        this.participantes = participantes;
        this.results = [];
    }

    // Iniciar carrera
    start() {
        document.getElementById('raceStatus').style.display = 'block';
        document.getElementById('startRaceButton').disabled = true;
        
        let raceInterval = setInterval(() => {
            this.participantes.forEach(part => {
                // Lógica de la carrera, avanzar participantes, mostrar resultados
                part.vehiculo.avanzar(this.circuito.tiempo);
            });
            
            // Mostrar resultados
            this.showResults();
            
            // Verificar si la carrera ha terminado
            if (this.participantes.every(p => p.distancia >= this.circuito.longitud)) {
                clearInterval(raceInterval);
                this.showFinalResults();
            }
        }, 500);
    }

    // Mostrar resultados de la carrera
    showResults() {
        const raceResults = document.getElementById('raceResults');
        raceResults.innerHTML = '';
        
        this.participantes.forEach(p => {
            const resultItem = document.createElement('p');
            resultItem.textContent = `${p.nombre}: ${p.distancia}m`;
            raceResults.appendChild(resultItem);
        });
    }

    // Mostrar resultados finales
    showFinalResults() {
        const raceResults = document.getElementById('raceResults');
        raceResults.innerHTML += '<h3>¡Carrera Terminada!</h3>';
        this.participantes.sort((a, b) => b.distancia - a.distancia);
        
        this.participantes.forEach((p, index) => {
            raceResults.innerHTML += `<p>${index + 1}. ${p.nombre} - ${p.distancia}m</p>`;
        });
    }
}

    </script>
</body>
</html>
